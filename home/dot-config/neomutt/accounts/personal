# vim: ft=muttrc

set folder     = ~/Mail/Personal
set spoolfile  = +INBOX
set record     = +Sent
set trash      = +Deleted
set postponed  = +Drafts
set from       = "christoph.ungricht@outlook.com"
set realname   = "Christoph Ungricht"

# Send email
set imap_user                  = 'christoph.ungricht@outlook.com'
set smtp_authenticators        = "xoauth2"
set ssl_starttls               = yes
set ssl_force_tls              = yes
set smtp_oauth_refresh_command = "/usr/share/neomutt/oauth2/mutt_oauth2.py ~/.config/neomutt/outlooktoken"
set smtp_url = "smtp://$imap_user@smtp.office365.com:587"

mailboxes  -label  "INBOX"   -notify   -poll   +INBOX
virtual-mailboxes  "Flagged"                   "notmuch://?query=tag:flagged and path:Personal/**"
mailboxes  -label  "Junk"    -notify   -poll   +Junk \
           -label  "Sent"    -nonotify -poll   +Sent \
           -label  "Drafts"  -nonotify -poll   +Drafts \
           -label  "Deleted" -nonotify -nopoll +Deleted

# Sidebar
set sidebar_width = 25
set sidebar_format = ' %D %* %?N? 󰇮 %2N? %?S? 󰇯 %5S?'

# NOTE: Remap for each account:
macro index I "<enter-command>unset wait_key<enter>\
<enter-command>echo 'Syncing account \"Personal\" with IMAP server in the background...'<enter>\
<shell-escape>bash -c '\
(mbsync Personal &>/dev/null &&\
notmuch new &>/dev/null &&\
notify-send \"Successfully syncd emails!\" &>/dev/null)\
|| notify-send -u critical \"Failed to sync emails\" &>/dev/null\
' &<enter>\
<enter-command>set wait_key=yes<enter>" \
        "sync IMAP account"

macro index,pager gi "<change-folder>+INBOX<enter>" "go to inbox"
macro index,pager Mi ";<save-message>+INBOX<enter>" "move mail to inbox"
macro index,pager Ci ";<copy-message>+INBOX<enter>" "copy mail to inbox"
macro index,pager gd "<change-folder>+Drafts<enter>" "go to drafts"
macro index,pager Md ";<save-message>+Drafts<enter>" "move mail to drafts"
macro index,pager Cd ";<copy-message>+Drafts<enter>" "copy mail to drafts"
macro index,pager gj "<change-folder>+Junk<enter>" "go to junk"
macro index,pager Mj ";<save-message>+Junk<enter>" "move mail to junk"
macro index,pager Cj ";<copy-message>+Junk<enter>" "copy mail to junk"
macro index,pager gt "<change-folder>+Trash<enter>" "go to trash"
macro index,pager Mt ";<save-message>+Trash<enter>" "move mail to trash"
macro index,pager Ct ";<copy-message>+Trash<enter>" "copy mail to trash"
macro index,pager gs "<change-folder>+Sent<enter>" "go to sent"
macro index,pager Ms ";<save-message>+Sent<enter>" "move mail to sent"
macro index,pager Cs ";<copy-message>+Sent<enter>" "copy mail to sent"
macro index,pager ga "<change-folder>+Archive<enter>" "go to archive"
macro index,pager Ma ";<save-message>+Archive<enter>" "move mail to archive"
macro index,pager Ca ";<copy-message>+Archive<enter>" "copy mail to archive"
macro index,pager gt "<change-folder>+Deleted<enter>" "go to trash"
macro index,pager Mt ";<save-message>+Deleted<enter>" "move mail to trash"
macro index,pager Ct ";<copy-message>+Deleted<enter>" "copy mail to trash"

